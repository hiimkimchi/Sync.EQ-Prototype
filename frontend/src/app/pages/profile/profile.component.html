<div
  class="d-flex justify-content-center align-items-center min-vh-100 py-4"
  style="
    position: relative;
    min-height: 100vh;
    width: 100%;
    overflow: hidden;
    background-image: url('https://www.aliveco.com/wp-content/uploads/2023/08/TheGorgeAmphitheater_20230527_335.jpg');
    background-size: cover;
    background-position: center;
    filter: brightness(80%);
  "
>
  <div
    class="position-relative container d-flex justify-content-center align-items-center"
    style="max-width: 1300px; height: 100vh; overflow: visible;"
  >

    <!-- PROFILE CARD -->
    <div
      [@profileSlide]="vinylOpen ? 'hidden' : 'visible'"
      class="shadow-lg overflow-visible d-flex flex-column p-5"
      style="
        position: absolute;
        border-radius: 1rem;
        display: flex;
        flex-direction: column;
        padding: 2rem;
        background: #ffffff; /* solid background */
        color: black; /* text color black */
        width: 90vh;
        height: 85vh;
      "
    >

      <!-- Toggle button -->
      <button
        class="btn btn-dark position-absolute"
        style="top: 1rem; right: 1rem;"
        (click)="toggleVinyl()"
      >
        View Records
      </button>

      <!-- Top Section -->
      <div class="row g-4">

        <!-- Left Column -->
        <div class="col-md-4 d-flex flex-column align-items-center justify-content-start">
          <div
            class="rounded-circle d-flex align-items-center justify-content-center overflow-hidden position-relative"
            (click)="triggerFileInput(profilePicInput)"
            style="
              width: 140px;
              height: 140px;
              background: #e7e7e7; /* solid ring */
              border: 1px solid rgba(0,0,0,0.2);
              cursor: pointer;
            "
          >
            <img
              [src]="profilePicPreview || profilePicURL"
              class="w-100 h-100 object-fit-cover"
              alt="Loading"
            />

            <!-- Change Indicator (Shown only if editable) -->
            <div
              *ngIf="isEditable"
              class="position-absolute bottom-0 w-100 text-center bg-dark bg-opacity-50 text-white small py-1"
            >
              Change
            </div>
                     
            <!-- Hidden file input -->
            <input
              type="file"
              #profilePicInput
              accept="image/*"
              style="display: none"
              (change)="onFileSelected($event)"
            />
            <button
              *ngIf="isEditable && profilePicFile"
              class="btn btn-primary btn-sm mt-2"
              (click)="updateProfilePic()"
            >
              Upload New Picture
            </button>
          </div>



          <div class="mt-3 text-center">
            <input-field
              [inputField]="user?.artistAlias"
              [isTitle]="true"
              [isEditable]="isEditable"
              (fieldUpdated)="updateUserField('artistAlias', $event)"
            ></input-field>

            <p style="color: rgba(0,0,0,0.85); margin-bottom: 0; font-size: 0.9rem;">
              {{ "@" + user?.username }}
            </p>
          </div>
        </div>

        <!-- Right Column -->
        <div class="col-md-8 d-flex flex-column justify-content-center">

          <div class="mb-3">
            <h6 style="color: rgba(0,0,0,0.85); font-weight: 600; text-transform: uppercase; margin-bottom: 0.5rem;">
              Main Roles
            </h6>
            <array-input-field
              [inputField]="user?.professions || []"
              [isEditable]="isEditable"
              (fieldUpdated)="updateUserField('professions', $event)"
            ></array-input-field>
          </div>

          <div class="mb-3">
            <h6 style="color: rgba(0,0,0,0.85); font-weight: 600; text-transform: uppercase; margin-bottom: 0.5rem;">
              Preferred Genres
            </h6>
            <array-input-field
              [inputField]="user?.genres || []"
              [isEditable]="isEditable"
              (fieldUpdated)="updateUserField('genres', $event)"
            ></array-input-field>
          </div>

          <div class="mb-3">
            <h6 style="color: rgba(0,0,0,0.85); font-weight: 600; text-transform: uppercase; margin-bottom: 0.5rem;">
              DAW(s)
            </h6>
            <select-input-field
              [inputField]="user?.daws || []"
              [options]="['FL Studio', 'Ableton', 'Logic Pro']"
              [isEditable]="isEditable"
              (fieldUpdated)="updateUserField('daws', $event)"
            ></select-input-field>
          </div>

        </div>
      </div>

      <!-- Bio Section -->
      <div class="mt-4 mb-2 overflow-auto">
        <div
          class="p-4 shadow-sm"
          style="
            border-radius: 1rem;
            background: #a09f9f; 
            color: black; /* text color black */
          "
        >
          <h5 style="font-weight: 600; margin-bottom: 1rem;">Bio</h5>

          <p style="margin-bottom: 0; font-size: 0.95rem; color: rgba(0,0,0,0.85);">
            {{ user?.biography || "No biography added yet." }}
          </p>
        </div>
      </div>
    </div>

    <!-- Vinyl Record -->
    <div
      [@vinylSlide]="vinylOpen ? 'visible' : 'hidden'"
      style="
        position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        width: clamp(260px, 35vw, 420px);
        height: clamp(260px, 35vw, 420px);
        z-index: 10;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
      "
    >
      <vinyl-record [isVisible]="vinylOpen" [profileUsername]="user?.username" [isEditable]="isEditable" style="width:100%; height:100%;"></vinyl-record>
    </div>

    <!-- Back Button -->
    <button
      *ngIf="vinylOpen"
      class="btn btn-dark"
      style="position: absolute; top: 12px; right: 12px; z-index: 9999;"
      (click)="toggleVinyl()"
      aria-label="Back to profile"
    >
      Back to Profile
    </button>
  </div>
</div>
